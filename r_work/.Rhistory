folders_df <- left_join(folders_df, folders_df, by =
c(this_folder = this_parent))
return(folders_df)
}
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folders_goofin <- get_parent_info(folder_goofin)
get_parent_info <- function(folders_df){
this_folder <- names(folder_df[ncol(folders_df)-1])
this_parent <- names(folder_df[ncol(folders_df)])
folders_df <- left_join(folders_df, folders_df, by =
c(this_folder = this_parent))
return(folders_df)
}
folders_goofin <- get_parent_info(folder_goofin)
get_parent_info <- function(folders_df){
this_folder <- names(folders_df[ncol(folders_df)-1])
this_parent <- names(folders_df[ncol(folders_df)])
folders_df <- left_join(folders_df, folders_df, by =
c(this_folder = this_parent))
return(folders_df)
}
folders_goofin <- get_parent_info(folder_goofin)
get_parent_info <- function(folders_df){
this_folder <- names(folders_df[ncol(folders_df)-1])
print(this_folder)
this_parent <- names(folders_df[ncol(folders_df)])
print(this_parent)
#folders_df <- left_join(folders_df, folders_df, by =
#                          c(this_folder = this_parent))
return(folders_df)
}
folders_goofin <- get_parent_info(folder_goofin)
get_parent_info <- function(folders_df){
this_folder <- names(folders_df[ncol(folders_df)-1])
print(this_folder)
this_parent <- names(folders_df[ncol(folders_df)])
print(this_parent)
folders_df <- left_join(folders_df, folders_df, by =
c(this_folder = this_parent))
return(folders_df)
}
folders_goofin <- get_parent_info(folder_goofin)
get_parent_info <- function(folders_df){
this_folder <- names(folders_df[ncol(folders_df)-1])
print(this_folder)
this_parent <- names(folders_df[ncol(folders_df)])
print(this_parent)
folders_df <- left_join(folders_df, folders_df, by =
c(this_folder = this_parent))
return(folders_df)
}
folder_goofin <- get_parent_info(folder_goofin)
remove(folders_goofin)
folder_goofin <- get_parent_info(folder_goofin)
get_parent_info <- function(folders_df){
this_folder <- names(folders_df[ncol(folders_df)-1])
print(this_folder)
this_parent <- names(folders_df[ncol(folders_df)])
print(this_parent)
folders_df <- left_join(folders_df, folders_df, by =
c(this_folder, this_parent))
return(folders_df)
}
folder_goofin <- get_parent_info(folder_goofin)
View(folder_goofin)
copy_df <- folders_df
get_parent_info <- function(folders_df){
copy_df <- folders_df
this_folder <- names(folders_df[ncol(folders_df)-1])
print(this_folder)
this_parent <- names(folders_df[ncol(folders_df)])
print(this_parent)
folders_df <- left_join(folders_df, copy_df, by =
c(this_folder, this_parent))
return(folders_df)
}
folder_goofin <- get_parent_info(folder_goofin)
get_parent_info <- function(folders_df){
copy_df <- folders_df
this_folder <- names(folders_df[ncol(folders_df)-1])
print(this_folder)
this_parent <- names(folders_df[ncol(folders_df)])
print(this_parent)
folders_df <- left_join(folders_df, copy_df, by =
c(this_parent, this_folder))
return(folders_df)
}
folder_goofin <- get_parent_info(folder_goofin)
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id.y" = "parent_id"))
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id.y" = "parent_id"))
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id.y" = "parent_id"), keep = FALSE)
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id.y" = "parent_id"), keep = FALSE, na_matches = FALSE)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id.y" = "parent_id"), keep = FALSE, na_matches = "never")
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y" = "parent_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y" = "parent_id"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y" = "parent_id.y"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y.y" = "parent_id.y"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.y)
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y" = "parent_id"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y.y" = "parent_id.y"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id.y" = "parent_id"))
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y" = "parent_id"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y.y" = "parent_id.y"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y" = "parent_id"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y.y" = "parent_id.y"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.x.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y.y.y.y" = "parent_id.y.y"), keep = FALSE,
na_matches = "never", multiple = "any")
is.na(all(folder_goofin[,ncol(folder_goofin)]))
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
folder_goofin <- left_join(folder_goofin, folder_goofin, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y" = "parent_id"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y.y" = "parent_id.y"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.x.y)
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y.y.y.y" = "parent_id.y.y"), keep = FALSE,
na_matches = "never", multiple = "any") %>%
select(-folder_id.x.x.y)
is.na(all(folder_goofin[,ncol(folder_goofin)]))
copy_df <- folder_goofin
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
folder_goofin <- left_join(folder_goofin, copy_df, by = c("parent_id" = "folder_id"))
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id.y" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- left_join(folder_goofin, folder_goofin, by =
c("parent_id.y.y" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
folder_goofin <- left_join(folder_goofin, copy_df, by = c("parent_id" = "folder_id"))
is.na(all(folder_goofin[,ncol(folder_goofin)]))
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id.y" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id.y.y" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id.y.y.y" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id.y.y.y.y" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
is.na(all(folder_goofin$parent_id.y.y.y.y.y))
is.na(all(folder_goofin$parent_id.y))
!is.na(any(folder_goofin$parent_id.y))
!is.na(any(folder_goofin$parent_id.y.y.y.y.y))
folder_goofin$parent_id.y.y.y.y.y
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id.y.y.y.y.y" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin$parent_id.y.y.y.y.y
folder_goofin$parent_id.y.y.y.y.y.y
folder_goofin$parent_id.y.y.y.y.y.y[1000:1999]
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id.y.y.y.y.y.y" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin$parent_id[1000:1999]
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("parent_id" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin$parent_id[1000:1999]
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
folder_goofin <- left_join(folder_goofin, copy_df, by = c("parent_id" = "folder_id"))
names(folder_goofin)
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("folder_depth_3" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
folder_goofin <- left_join(folder_goofin, copy_df, by = c("parent_id" = "folder_id"))
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folder_goofin) <- new_names
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("folder_depth_3" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folder_goofin) <- new_names
folder_goofin <- left_join(folder_goofin, copy_df, by =
c("folder_depth_4" = "folder_id"), keep = FALSE,
na_matches = "never", multiple = "any")
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
is.na(folder_goofin$parent_id)
!is.na(folder_goofin$parent_id)
is.na(all(folder_goofin$parent_id))
all(is.na(folder_goofin$parent_id))
get_next_gen <- function(folders_df, cloned_df){
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"))
if (all(is.na(folders_df$folder_id))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
get_next_gen <- function(folders_df, cloned_df){
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
if (all(is.na(folders_df$folder_id))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folders_goofin <- get_next_gen(folder_goofin, copy_df)
folder_goofin <- left_join(folder_goofin, copy_df, by = c("parent_id" = "folder_id"))
get_next_gen <- function(folders_df, cloned_df){
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
if (all(is.na(folders_df$folder_id))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- get_next_gen(folder_goofin, copy_df)
remove(folders_goofin)
get_next_gen <- function(folders_df, cloned_df){
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
if (all(is.na(folders_df$folder_id.y))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
get_next_gen <- function(folders_df, cloned_df){
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
if (all(is.na(folders_df$parent_id.y))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- get_next_gen(folder_goofin, copy_df)
get_next_gen <- function(folders_df, cloned_df){
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
if (all(is.na(folders_df$parent_id.y))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- get_next_gen(folder_goofin, copy_df)
get_next_gen <- function(folders_df, cloned_df){
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
if (all(is.na(folders_df$parent_id))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
folder_goofin <- get_next_gen(folder_goofin, copy_df)
get_next_gen <- function(folders_df, cloned_df){
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
if (all(is.na(folders_df$parent_id))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- get_next_gen(folder_goofin, copy_df)
rlang:last_trace()
rlang::last_trace()
rlang::last_trace(drop = FALSE)
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
get_next_gen <- function(folders_df, cloned_df){
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never")
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
if (all(is.na(folders_df$parent_id))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- get_next_gen(folder_goofin, copy_df)
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
get_next_gen <- function(folders_df, cloned_df){
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
print(names(folders_df))
new_names <- c()
for (i in 1:ncol(folder_goofin)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
if (all(is.na(folders_df$parent_id))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- get_next_gen(folder_goofin, copy_df)
folder_goofin <- all_folders %>%
select(folder_id, parent_id)
copy_df <- folder_goofin
get_next_gen <- function(folders_df, cloned_df){
folders_df <- left_join(folders_df, cloned_df, by = c("parent_id" = "folder_id"),
keep = FALSE, na_matches = "never", multiple = "any")
print(names(folders_df))
new_names <- c()
for (i in 1:ncol(folders_df)){
new_names[i] <- paste0("folder_depth_", i)
}
names(folders_df) <- new_names
names(folders_df)[ncol(folders_df)] <- "parent_id"
if (all(is.na(folders_df$parent_id))){
return(folders_df)
}
else {
folders_df <- get_next_gen(folders_df, cloned_df)
}
}
folder_goofin <- get_next_gen(folder_goofin, copy_df)
## Load what's needed
if (!("pacman" %in% rownames(installed.packages()))) {
install.packages("pacman")
}
## Load what's needed
if (!("pacman" %in% rownames(installed.packages()))) {
install.packages("pacman")
}
pacman::p_load(tidyverse, DBI, RPostgreSQL, keyring)
source("01_nprb-inventory_functions.R")
# connect to the RW db
psql <- dbDriver("PostgreSQL")
con <- dbConnect(
drv = psql,
dbname = "research_workspace",
host = "oltp.db.axiomptk",
port = 5432,
password = key_get("research_workspace", keyring = "dbs"),
user = key_list("research_workspace", keyring = "dbs")[1,2]
)
con <- dbConnect(
drv = psql,
dbname = "research_workspace",
host = "oltp.db.axiomptk",
port = 5432,
password = key_get("research_workspace", keyring = "dbs"),
user = key_list("research_workspace", keyring = "dbs")[1,2]
)
key_list()
keyring_list()\
keyring_list()
